### Документация по использованию CLI:

#### Установка:

```bash
# Собрать и установить
go build -o ipset-cli cmd/cli/main.go
sudo mv ipset-cli /usr/local/bin/

# Или использовать скрипт установки
chmod +x install.sh
./install.sh
```

#### Конфигурация:

```bash
# Установить API URL
ipset-cli config set api_url http://localhost:8080

# Установить формат вывода по умолчанию
ipset-cli config set output table

# Просмотреть текущую конфигурацию
ipset-cli config view
```

#### Аутентификация:

```bash
# Получить JWT токен
ipset-cli login your-api-key-here

# Токен автоматически сохранится в конфиг
```

#### Управление записями:

```bash
# Создать новую запись
ipset-cli records create \
  --ip 192.168.1.100 \
  --cidr 32 \
  --port 80 \
  --protocol tcp \
  --description "Web server" \
  --context "production web server"

# Создать простую запись (только IP)
ipset-cli records create \
  --ip 10.0.0.1 \
  --context "internal server"

# Список всех записей
ipset-cli records list

# Получить запись по ID
ipset-cli records get 100001

# Обновить запись
ipset-cli records update 100001 \
  --description "Updated web server" \
  --port 443

# Удалить запись
ipset-cli records delete 100001

# Поиск по контексту
ipset-cli records search "production"
Различные форматы вывода:
bash
# Табличный вывод (по умолчанию)
ipset-cli --output table records list

# JSON вывод
ipset-cli --output json records list

# YAML вывод
ipset-cli --output yaml records list

# IPSet правила
ipset-cli --output ipset records list
Экспорт в ipset:
bash
# Экспортировать все записи как ipset правила
ipset-cli export > rules.sh

# Экспортировать конкретную запись
ipset-cli export 100001

# Применить правила напрямую
ipset-cli export | bash
```

#### Примеры использования с различными форматами:

- Табличный вывод:

```bash
$ ipset-cli records list
┌────────┬───────────────┬──────┬──────┬──────────┬─────────────────┬──────────────────────────────────┬────────────┐
│  ID    │ IP            │ CIDR │ Port │ Protocol │ Description     │ Context                          │ Created    │
├────────┼───────────────┼──────┼──────┼──────────┼─────────────────┼──────────────────────────────────┼────────────┤
│ 100001 │ 192.168.1.100 │ 32   │ 80   │ tcp      │ Web server      │ production web server            │ 2024-01-15 │
│ 100002 │ 10.0.0.1      │      │      │          │ Internal server │ internal infrastructure         │ 2024-01-15 │
└────────┴───────────────┴──────┴──────┴──────────┴─────────────────┴──────────────────────────────────┴────────────┘
```

- JSON вывод:

```json
$ ipset-cli --output json records list
[
  {
    "id": 100001,
    "ip": "192.168.1.100",
    "cidr": "32",
    "port": 80,
    "protocol": "tcp",
    "description": "Web server",
    "context": "production web server",
    "created_at": "2024-01-15T10:00:00Z"
  }
]
```

- YAML вывод:

```yaml
$ ipset-cli --output yaml records list
- id: 100001
  ip: 192.168.1.100
  cidr: "32"
  port: 80
  protocol: tcp
  description: Web server
  context: production web server
  created_at: 2024-01-15T10:00:00Z
```

- IPSet правила:

```bash
$ ipset-cli --output ipset records list
#!/bin/bash
# IPSet rules generated by ipset-cli

# Create TCP set if not exists
ipset create tcp_set hash:ip,port -exist

# Rule ID: 100001 - Web server
ipset add tcp_set 192.168.1.100/32,tcp:80

# Example iptables rules:
# iptables -A INPUT -m set --match-set tcp_set src -j ACCEPT
```

- Интерактивный режим (с использованием fzf):

```bash
#!/bin/bash
# ipset-interactive.sh

# Выбрать запись через fzf и показать детали
record=$(ipset-cli --output json records list | jq -r '.[] | "\(.id): \(.ip) - \(.description)"' | fzf)
if [ ! -z "$record" ]; then
    id=$(echo $record | cut -d':' -f1)
    ipset-cli records get $id --output yaml
fi
```

- Алиасы для удобства:
```bash
# Добавить в ~/.bashrc или ~/.zshrc
alias ipset-list='ipset-cli records list'
alias ipset-get='ipset-cli records get'
alias ipset-search='ipset-cli records search'
alias ipset-export='ipset-cli export'
alias ipset-json='ipset-cli --output json records list'
alias ipset-yaml='ipset-cli --output yaml records list'
```

CLI приложение предоставляет:

✅ Полный набор команд для управления записями

✅ Поддержка JSON, YAML, табличного и ipset форматов

✅ Сохранение конфигурации (токен, URL, настройки)

✅ Цветной табличный вывод

✅ Экспорт в готовые ipset правила

✅ Автоматическое создание ipset sets

✅ Интуитивный интерфейс командной строки